<odoo>
    <template id="report_stock_report">
        <t t-call="web.html_container">
            <t t-call="web.external_layout">
                <div class="page" style="color: #000000; background-color: #ffffff;">
                    <div class="text-center" style="margin-bottom: 25px;">
                        <h2 style="color: #1e3a8a; font-weight: bold; text-transform: uppercase;">
                            Stock Report
                        </h2>
                    </div>

                    <div class="row" style="margin-bottom: 20px;">
                        <div class="col-12">
                            <table class="table table-sm table-bordered"
                                   style="border: 1px solid #dee2e6; color: #000000;">
                                <thead style="background-color: #f1f5f9; font-size: 14px;">
                                    <tr>
                                        <th style="width: 15%; padding-left: 10px; color: #1e3a8a;">Company:</th>
                                        <td style="width: 35%;">
                                            <t t-esc="report_company_id"/>
                                        </td>
                                        <th style="width: 15%; padding-left: 10px; color: #1e3a8a;">Start Date:</th>
                                        <td style="width: 35%;">
                                            <t t-esc="report_start_date" t-options='{"widget": "date"}'/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th style="padding-left: 10px; color: #1e3a8a;">Location Filter:</th>
                                        <td>
                                            <t t-esc="report_location"/>
                                        </td>
                                        <th style="padding-left: 10px; color: #1e3a8a;">End Date:</th>
                                        <td>
                                            <t t-esc="report_end_date" t-options='{"widget": "date"}'/>
                                        </td>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                    </div>

                    <div>
                        <table class="table table-sm table-bordered" style="border: 1px solid #dee2e6; color: #000000;">
                            <thead style="background-color: #1e3a8a; color: #ffffff;">
                                <tr style="font-size: 13px;">
                                    <th class="text-center align-middle" style="width: 10%;">Reference</th>
                                    <th class="text-left align-middle" style="width: 25%;">Designation</th>
                                    <th class="text-center align-middle" style="width: 5%;">UoM</th>
                                    <th class="text-center align-middle" style="width: 5%;">HSN</th>
                                    <th class="text-right align-middle" style="width: 10%;">Initial Stock</th>
                                    <th class="text-right align-middle" style="width: 5%;">In</th>
                                    <th class="text-right align-middle" style="width: 5%;">Out</th>
                                    <th class="text-right align-middle" style="width: 5%;">Balance</th>
                                    <th class="text-right align-middle" style="width: 7%;">Sale Price</th>
                                    <th class="text-right align-middle" style="width: 8%;">Sale Value</th>
                                    <th class="text-right align-middle" style="width: 7%;">Cost Price</th>
                                    <th class="text-right align-middle" style="width: 8%;">Cost Value</th>
                                </tr>
                            </thead>
                            <tbody style="font-size: 12px; background-color: #ffffff;">

                                <t t-foreach="locations_data" t-as="loc_name">
                                    <tr>
                                        <th colspan="12" class="text-left"
                                            style="background-color: #dbeafe; color: #1e3a8a; font-size: 14px; padding-left: 10px;">
                                          <strong t-esc="loc_name"/>
                                        </th>
                                    </tr>

                                    <t t-if="not report_group_by_category">
                                        <t t-foreach="locations_data[loc_name]" t-as="line">
                                            <tr style="background-color: transparent;">
                                                <td class="text-center">
                                                    <span t-esc="line['default_code']"/>
                                                </td>
                                                <td class="text-left">
                                                    <span t-esc="line['product']"/>
                                                </td>
                                                <td class="text-center">
                                                    <span t-esc="line['uom']"/>
                                                </td>
                                                <td class="text-center">
                                                    <span t-esc="line['hsn']"/>
                                                </td>
                                                <td class="text-right">
                                                    <span t-esc="line['initial_stock']"
                                                          t-options='{"widget": "float", "precision": 2}'/>
                                                </td>
                                                <td class="text-right">
                                                    <span t-esc="line['in']"
                                                          t-options='{"widget": "float", "precision": 2}'/>
                                                </td>
                                                <td class="text-right">
                                                    <span t-esc="line['out']"
                                                          t-options='{"widget": "float", "precision": 2}'/>
                                                </td>
                                                <td class="text-right" style="font-weight: bold;">
                                                    <span t-esc="line['balance']"
                                                          t-options='{"widget": "float", "precision": 2}'/>
                                                </td>
                                                <td class="text-right">
                                                    <span t-esc="line['sale_price']"
                                                          t-options='{"widget": "float", "precision": 2}'/>
                                                </td>
                                                <td class="text-right">
                                                    <span t-esc="line['sale_value']"
                                                          t-options='{"widget": "float", "precision": 2}'/>
                                                </td>
                                                <td class="text-right">
                                                    <span t-esc="line['cost_price']"
                                                          t-options='{"widget": "float", "precision": 2}'/>
                                                </td>
                                                <td class="text-right">
                                                    <span t-esc="line['cost_value']"
                                                          t-options='{"widget": "float", "precision": 2}'/>
                                                </td>
                                            </tr>
                                        </t>
                                    </t>

                                    <t t-if="report_group_by_category">
                                        <t t-foreach="locations_data[loc_name]" t-as="cat_name">
                                            <tr>
                                                <th colspan="12" class="text-left"
                                                    style="background-color: #f1f5f9; color: #334155; font-size: 13px; padding-left: 20px; border-bottom: 1px solid #cbd5e1;">
                                                    <strong>Category:</strong>
                                                    <t t-esc="cat_name"/>
                                                </th>
                                            </tr>
                                            <t t-foreach="locations_data[loc_name][cat_name]" t-as="line">
                                                <tr style="background-color: transparent;">
                                                    <td class="text-center">
                                                        <span t-esc="line['default_code']"/>
                                                    </td>
                                                    <td class="text-left">
                                                        <span t-esc="line['product']"/>
                                                    </td>
                                                    <td class="text-center">
                                                        <span t-esc="line['uom']"/>
                                                    </td>
                                                    <td class="text-center">
                                                        <span t-esc="line['hsn']"/>
                                                    </td>
                                                    <td class="text-right">
                                                        <span t-esc="line['initial_stock']"
                                                              t-options='{"widget": "float", "precision": 2}'/>
                                                    </td>
                                                    <td class="text-right">
                                                        <span t-esc="line['in']"
                                                              t-options='{"widget": "float", "precision": 2}'/>
                                                    </td>
                                                    <td class="text-right">
                                                        <span t-esc="line['out']"
                                                              t-options='{"widget": "float", "precision": 2}'/>
                                                    </td>
                                                    <td class="text-right" style="font-weight: bold;">
                                                        <span t-esc="line['balance']"
                                                              t-options='{"widget": "float", "precision": 2}'/>
                                                    </td>
                                                    <td class="text-right">
                                                        <span t-esc="line['sale_price']"
                                                              t-options='{"widget": "float", "precision": 2}'/>
                                                    </td>
                                                    <td class="text-right">
                                                        <span t-esc="line['sale_value']"
                                                              t-options='{"widget": "float", "precision": 2}'/>
                                                    </td>
                                                    <td class="text-right">
                                                        <span t-esc="line['cost_price']"
                                                              t-options='{"widget": "float", "precision": 2}'/>
                                                    </td>
                                                    <td class="text-right">
                                                        <span t-esc="line['cost_value']"
                                                              t-options='{"widget": "float", "precision": 2}'/>
                                                    </td>
                                                </tr>
                                            </t>

                                            <tr style="background-color: #f8fafc; color: #0f172a; font-weight: bold; font-size: 12px;">
                                                <td colspan="4" class="text-right" style="color: #334155;">Category
                                                    Subtotal:
                                                </td>
                                                <td class="text-right">
                                                    <span t-esc="category_totals_by_loc[loc_name][cat_name]['initial_stock']"
                                                          t-options='{"widget": "float", "precision": 2}'/>
                                                </td>
                                                <td class="text-right">
                                                    <span t-esc="category_totals_by_loc[loc_name][cat_name]['in']"
                                                          t-options='{"widget": "float", "precision": 2}'/>
                                                </td>
                                                <td class="text-right">
                                                    <span t-esc="category_totals_by_loc[loc_name][cat_name]['out']"
                                                          t-options='{"widget": "float", "precision": 2}'/>
                                                </td>
                                                <td class="text-right">
                                                    <span t-esc="category_totals_by_loc[loc_name][cat_name]['balance']"
                                                          t-options='{"widget": "float", "precision": 2}'/>
                                                </td>
                                                <td></td>
                                                <td class="text-right">
                                                    <span t-esc="category_totals_by_loc[loc_name][cat_name]['sale_value']"
                                                          t-options='{"widget": "float", "precision": 2}'/>
                                                </td>
                                                <td></td>
                                                <td class="text-right">
                                                    <span t-esc="category_totals_by_loc[loc_name][cat_name]['cost_value']"
                                                          t-options='{"widget": "float", "precision": 2}'/>
                                                </td>
                                            </tr>
                                        </t>
                                    </t>

                                    <tr style="background-color: #e2e8f0; color: #0f172a; font-weight: bold; font-size: 13px;">
                                        <td colspan="4" class="text-right" style="color: #1e3a8a;">Total:</td>
                                        <td class="text-right">
                                            <span t-esc="location_totals[loc_name]['initial_stock']"
                                                  t-options='{"widget": "float", "precision": 2}'/>
                                        </td>
                                        <td class="text-right">
                                            <span t-esc="location_totals[loc_name]['in']"
                                                  t-options='{"widget": "float", "precision": 2}'/>
                                        </td>
                                        <td class="text-right">
                                            <span t-esc="location_totals[loc_name]['out']"
                                                  t-options='{"widget": "float", "precision": 2}'/>
                                        </td>
                                        <td class="text-right">
                                            <span t-esc="location_totals[loc_name]['balance']"
                                                  t-options='{"widget": "float", "precision": 2}'/>
                                        </td>
                                        <td></td>
                                        <td class="text-right">
                                            <span t-esc="location_totals[loc_name]['sale_value']"
                                                  t-options='{"widget": "float", "precision": 2}'/>
                                        </td>
                                        <td></td>
                                        <td class="text-right">
                                            <span t-esc="location_totals[loc_name]['cost_value']"
                                                  t-options='{"widget": "float", "precision": 2}'/>
                                        </td>
                                    </tr>
                                </t>
                            </tbody>

                            <tfoot>
                                <tr style="background-color: #10b981; color: #ffffff; font-weight: bold; font-size: 14px;">
                                    <td colspan="4" class="text-right">GRAND TOTAL:</td>
                                    <td class="text-right">
                                        <span t-esc="total_initial_stock"
                                              t-options='{"widget": "float", "precision": 2}'/>
                                    </td>
                                    <td class="text-right">
                                        <span t-esc="total_in" t-options='{"widget": "float", "precision": 2}'/>
                                    </td>
                                    <td class="text-right">
                                        <span t-esc="total_out" t-options='{"widget": "float", "precision": 2}'/>
                                    </td>
                                    <td class="text-right">
                                        <span t-esc="total_balance" t-options='{"widget": "float", "precision": 2}'/>
                                    </td>
                                    <td></td>
                                    <td class="text-right">
                                        <span t-esc="total_sale_value" t-options='{"widget": "float", "precision": 2}'/>
                                    </td>
                                    <td></td>
                                    <td class="text-right">
                                        <span t-esc="total_cost_value" t-options='{"widget": "float", "precision": 2}'/>
                                    </td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </t>
        </t>
    </template>
</odoo>